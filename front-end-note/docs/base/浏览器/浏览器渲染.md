# 浏览器渲染
页面是采用流式布局来绘制，左到右，上到下

## 1、URL输入到页面展示 

1. 构建请求
2. 查找强缓存
3. 域名解析，找到服务地址
4. 建立 TCP 连接
5. 发送 HTTP 请求
6. 解析文档
7. 构建 DOM 树和 CSSOM 树
8. 生成渲染树：从 DOM 树的根节点开始遍历每个可见节点，并根据 CSSOM 树中对应的规则组合生成渲染树
9. Layout：根据生成的渲染树，进行回流，得到节点的集合信息
10. Painting：根据渲染树及其回流得到的集合信息，得到节点的绝对像素。
11. 输出像素绘制在页面上展示

## 2、回流与重绘
**回流**指元素的空间属性发生变化，重新进行收集节点信息对受影响的元素进行绘制。  
**重绘**指的是对元素的外观做处理，比如颜色、背景、阴影等。  
因此回流一定触发重绘。

以下几个动作会触发回流：

- 添加或删除可见的DOM元素
- 元素的位置发生变化
- 元素的尺寸发生变化（包括外边距、内边框、边框大小、高度和宽度等）
- 内容发生变化，比如文本变化或图片被另一个不同尺寸的图片所替代。
- 页面最初开始渲染的时候
- 浏览器的窗口尺寸变化（回流是根据视口的大小来计算元素的位置和大小的）
- 获取位置信息，需要回流计算最新的值

> 页面更新时机由浏览器控制，当 Eventloop 执行完 Microtasks 后浏览器会判断是否需要更新。  
> 更新时会先触发 requestAnimationFrame，之后计算样式并更新页面
